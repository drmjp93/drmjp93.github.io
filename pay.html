<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Telemedicine ‚Äî Payment</title>
<meta name="description" content="Device aware UPI payment page ‚Äî Telemedicine" />
<style>
:root{
  --bg:#f5f7fa; --card:#fff; --muted:#6b7280; --accent:#0b1220; --pill-h:56px;
}
*{box-sizing:border-box}
body{
  margin:0; padding:20px;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg); color:var(--accent);
}

/* top */
.topbar{ display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.back{ background:#0b1220; color:#fff; padding:10px 14px; border-radius:10px; text-decoration:none; font-weight:800; }

/* grid */
.container{ max-width:1100px; margin:22px auto; display:grid; grid-template-columns:1fr 460px; gap:20px; align-items:flex-start;}
@media(max-width:920px){ .container{ grid-template-columns:1fr; } }

/* left card */
.card-left{ background:#0b1220; color:#fff; border-radius:14px; padding:22px; min-height:520px; }
.card-left h2{ margin:0 0 12px; font-size:1.4rem; }
.rules{ color:#e6eef9; line-height:1.6; }

/* right card */
.card-right{ background:var(--card); border-radius:14px; padding:18px; box-shadow:0 8px 30px rgba(15,15,15,0.06); }
.alert{ background:#fffbea; border:1px solid #f6e29b; padding:10px 12px; border-radius:10px; font-weight:700; margin-bottom:14px; color:#6b7280; }

/* method pills (mobile) */
.methods{ display:flex; flex-direction:column; gap:12px; margin-bottom:12px; }
.pill{
  display:flex; align-items:center; gap:12px; height:var(--pill-h); border-radius:12px;
  background:#fff; border:1px solid #e9eef6; overflow:hidden; padding:6px; transition:box-shadow .14s ease, transform .12s ease;
}
.pill .left{ flex:1; display:flex; flex-direction:column; justify-content:center; padding:6px 12px; min-width:0; }
.pill .title{ font-weight:900; font-size:1rem; }
.pill .desc{ color:var(--muted); font-size:.90rem; }
.pill .action{
  flex:0 0 110px; display:inline-flex; align-items:center; justify-content:center;
  background:linear-gradient(180deg,#0b1220,#111827); color:#fff; border-radius:10px;
  padding:10px 12px; font-weight:900; cursor:pointer; border:0;
}
.pill:focus-within, .pill:focus{ outline:none; box-shadow:0 0 0 4px rgba(59,130,246,0.10); }
.pill:hover{ transform:translateY(-2px); box-shadow:0 12px 30px rgba(11,18,32,0.06); }

/* show QR toggle (mobile) */
#showQRtoggle{ margin-top:8px; background:#eef2f7; border-radius:8px; padding:10px; text-align:center; font-weight:700; cursor:pointer; }

/* Scan & Pay card */
.scanpay{ margin-top:12px; border:1px solid #e7eef6; border-radius:12px; padding:12px; background:#fff; }
.scanpay .row{ display:flex; gap:12px; align-items:center; }
.scanpay .leftLabel{ flex:0 0 120px; border-radius:8px; background:#f8fafc; display:flex; align-items:center; justify-content:center; font-weight:900; color:#0b1220; height:120px; text-align:center; padding:8px; }
.scanpay .rightQR{ flex:1; display:flex; align-items:center; gap:12px; padding:8px; justify-content:center; }
.qr-img{ width:160px; height:160px; border-radius:8px; border:1px solid #eaeff6; object-fit:contain; background:#fff; }

/* UPI plain (desktop & iPad) */
.upi-plain{
  display:none; margin-top:12px; text-align:center; font-weight:900; color:#0b1220;
  background:#f9fafb; padding:10px; border-radius:10px; border:1px solid #eef2f7;
}

/* full-width copy button (mobile) */
.copy-full{ margin-top:12px; display:none; gap:8px; }
.copy-full .copywide{ flex:1; background:#0b1220; color:#fff; padding:12px; border-radius:10px; border:0; font-weight:900; cursor:pointer; }

/* Amount / presets */
.amount-row{ margin-top:12px; display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.amount-row label{ font-weight:900; min-width:70px; }
.amount-row input{ padding:8px 10px; border-radius:8px; border:1px solid #ddd; width:120px; text-align:center; font-weight:800; }
.preset{ padding:8px 12px; border-radius:8px; background:#eef6ff; border:1px solid #e0efff; font-weight:800; cursor:pointer; }

/* total summary bar with amount on right */
.totalbar{ margin-top:14px; display:flex; align-items:center; justify-content:space-between; background:#f1f6fb; padding:14px; border-radius:10px; }
.totalbar .label{ color:var(--muted); font-weight:800; }
.totalbar .amt{ font-weight:900; font-size:1.3rem; background:#fff; padding:6px 12px; border-radius:8px; }

/* split CTA */
.split-cta{ margin-top:18px; display:flex; border-radius:12px; overflow:hidden; border:1px solid #e7eef6; background:#fff; height:64px; }
.split-cta .left{ flex:1; padding:10px 14px; display:flex; flex-direction:column; justify-content:center; min-width:0; }
.split-cta .left .l1{ font-weight:900; font-size:1.02rem; color:#0b1220; text-transform:uppercase; white-space:normal; word-break:break-word; }
.split-cta .left .l2{ color:var(--muted); font-weight:700; font-size:.90rem; margin-top:4px; }
.split-cta .right{ width:160px; background:#0b1220; color:#fff; display:flex; align-items:center; justify-content:center; font-weight:900; cursor:pointer; }

/* responsive */
@media(max-width:640px){
  .scanpay .row{ flex-direction:column; align-items:center; gap:8px; }
  .scanpay .leftLabel{ width:100%; height:56px; }
  .qr-img{ width:220px; height:220px; }
  .split-cta{ flex-direction:row; height:auto; }
  .split-cta .right{ width:140px; padding:12px 10px; }
  .copy-full{ display:flex; }
  .methods{ display:flex; }
}
@media(max-width:420px){
  .split-cta{ flex-direction:column; }
  .split-cta .right{ width:100%; border-top:1px solid rgba(0,0,0,0.04); }
}

/* toast */
#openToast{ position:fixed; left:50%; transform:translateX(-50%); bottom:22px; background:rgba(11,18,32,0.95); color:#fff; padding:10px 14px; border-radius:12px; display:none; font-weight:700; z-index:9999; }
</style>
</head>
<body>

<div class="topbar">
  <a class="back" href="telemedicine.html">‚Üê Back</a>
  <div style="color:var(--muted);font-weight:700">Secure payment</div>
</div>

<div class="container">
  <!-- LEFT -->
  <aside class="card-left">
    <h2>Telemedicine ‚Äî Rules</h2>
    <div class="rules">
      <p><strong>Before consultation</strong></p>
      <ul>
        <li>Appointment given only after payment.</li>
        <li>Fill confirmation form after payment to share contact & payment details.</li>
        <li>Emergency ‚Üí go to nearest hospital immediately.</li>
      </ul>

      <p style="margin-top:10px;"><strong>Follow-up</strong></p>
      <ul>
        <li>Same problem within 72 hrs ‚Äî free.</li>
        <li>After 72 hrs ‚Äî ‚Çπ300.</li>
      </ul>

      <p style="margin-top:14px;color:#dbe6f5;">After payment, please fill the confirmation form. Consultation slot details will be shared on that number.</p>
    </div>
  </aside>

  <!-- RIGHT -->
  <section class="card-right">
    <div class="alert">‚ö†Ô∏è Confirm Payee Name: <strong>Mit J Panchani</strong></div>

    <!-- method pills (mobile only) -->
    <div id="methodsWrapper" class="methods" aria-hidden="true"></div>

    <!-- show QR toggle (mobile only) -->
    <div id="showQRtoggle" aria-hidden="true">üì∑ Show QR Code</div>

    <!-- Scan & Pay card -->
    <div class="scanpay" id="scanpay" aria-hidden="true">
      <div class="row">
        <div class="leftLabel">SCAN &amp; PAY</div>
        <div class="rightQR">
          <img id="qrImg" class="qr-img" src="qr.jpg" alt="QR">
        </div>
      </div>
      <!-- UPI plain shown below QR only on desktop/iPad -->
      <div class="upi-plain" id="upiPlain" aria-hidden="true">drmjp93@upi</div>
    </div>

    <!-- full-width copy (mobile only) -->
    <div class="copy-full" id="copyFull" aria-hidden="true">
      <button class="copywide" id="copyWide">Copy UPI ID</button>
    </div>

    <!-- Amount controls -->
    <div class="amount-row">
      <label for="amountInput">Amount</label>
      <input id="amountInput" type="number" value="400" min="1" />
      <button class="preset" data-val="400">‚Çπ400</button>
      <button class="preset" data-val="300">‚Çπ300</button>
    </div>

    <!-- Total bar -->
    <div class="totalbar">
      <div class="label">Total price</div>
      <div class="amt" id="bigAmount">‚Çπ 400</div>
    </div>

    <!-- split CTA -->
    <div class="split-cta" role="group" aria-label="After payment submit confirmation">
      <div class="left">
        <div class="l1">AFTER PAYMENT</div>
        <div class="l2">SUBMIT CONFIRMATION FORM (COMPULSORY)</div>
      </div>
      <div class="right" id="openFormBtn">OPEN FORM</div>
    </div>
  </section>
</div>

<div id="openToast" role="status" aria-live="polite"></div>

<script>
/* --- Device detection: treat iPad as desktop --- */
function isAndroid(){ return /Android/i.test(navigator.userAgent); }
function isIPhone(){ return /iPhone|iPod/i.test(navigator.userAgent); }
const isIPadLike = (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1) || /iPad/.test(navigator.userAgent);
const device = isAndroid() ? 'android' : isIPhone() ? 'ios' : 'desktop'; // iPadLike falls to desktop branch
document.body.classList.add('is-' + device);

/* --- Config --- */
const UPI_ID = 'drmjp93@upi';
const PAYEE = 'Mit J Panchani';
const NOTE = 'Telemedicine Consultation';
const FORM_URL = 'https://docs.google.com/forms/d/e/1FAIpQLSegoCeodeLpgCAXnSki_0kS74YONXKT_RtRl5jlyX9hAfmtbw/viewform?usp=dialog';

/* --- Elements --- */
const methodsWrapper = document.getElementById('methodsWrapper');
const showQRtoggle = document.getElementById('showQRtoggle');
const scanpay = document.getElementById('scanpay');
const upiPlain = document.getElementById('upiPlain');
const copyFull = document.getElementById('copyFull');
const copyWide = document.getElementById('copyWide');
const amountInput = document.getElementById('amountInput');
const bigAmount = document.getElementById('bigAmount');
const openFormBtn = document.getElementById('openFormBtn');
const qrImg = document.getElementById('qrImg');
const toast = document.getElementById('openToast');

/* --- Methods config --- */
const METHODS = {
  whatsapp:{ title:'WhatsApp Pay', desc:'Open WhatsApp UPI', pkg:null },
  gpay:{ title:'Google Pay', desc:'Open GPay', pkg:'com.google.android.apps.nbu.paisa.user' },
  phonepe:{ title:'PhonePe', desc:'Open PhonePe', pkg:'com.phonepe.app' },
  bhim:{ title:'BHIM / UPI', desc:'Open any UPI app', pkg:'in.org.npci.upiapp' }
};

/* --- Helpers --- */
function enc(s){ return encodeURIComponent(s); }
function buildUPI(amount){
  const a = Number(amount)||0;
  const safe = (isFinite(a)&&a>0)? a.toFixed(2) : '0.00';
  return `upi://pay?pa=${enc(UPI_ID)}&pn=${enc(PAYEE)}&am=${enc(safe)}&tn=${enc(NOTE)}&cu=INR`;
}
function intentURI(pkg, upi){ return `intent://${upi.replace('upi://','')}#Intent;package=${pkg};scheme=upi;end`; }
function showToast(msg, ms=900){ toast.textContent = msg; toast.style.display='block'; clearTimeout(toast._t); toast._t = setTimeout(()=> toast.style.display='none', ms); }

/* --- Build mobile pills (only on phones) --- */
function createPill(def, key){
  const p = document.createElement('div'); p.className='pill'; p.dataset.key=key;
  p.innerHTML = `<div class="left"><div class="title">${def.title}</div><div class="desc">${def.desc}</div></div><div class="action">OPEN</div>`;
  const openHandler = (ev)=>{
    ev && ev.stopPropagation();
    const upi = buildUPI(amountInput.value);
    if(device === 'android' && def.pkg){
      // try intent
      window.location.href = intentURI(def.pkg, upi);
    } else {
      window.location.href = upi;
    }
  };
  // clicking pill opens directly
  p.addEventListener('click', ()=>{ p.style.transform='translateY(-3px)'; setTimeout(()=>p.style.transform='none',120); openHandler(); });
  // action area separately
  p.querySelector('.action').addEventListener('click', (e)=>{ e.stopPropagation(); openHandler(); });
  return p;
}
function buildMethodsUI(){
  methodsWrapper.innerHTML = '';
  if(device === 'desktop') return;
  if(device === 'ios'){
    methodsWrapper.appendChild(createPill(METHODS.whatsapp,'whatsapp'));
    methodsWrapper.appendChild(createPill(METHODS.bhim,'bhim'));
  } else {
    methodsWrapper.appendChild(createPill(METHODS.gpay,'gpay'));
    methodsWrapper.appendChild(createPill(METHODS.phonepe,'phonepe'));
    methodsWrapper.appendChild(createPill(METHODS.bhim,'bhim'));
    methodsWrapper.appendChild(createPill(METHODS.whatsapp,'whatsapp'));
  }
}

/* --- UI behaviour based on device --- */
function setupUI(){
  const isMobile = (device === 'android' || device === 'ios');
  methodsWrapper.style.display = isMobile ? 'flex' : 'none';
  showQRtoggle.style.display = isMobile ? 'block' : 'none';
  scanpay.style.display = isMobile ? 'none' : 'block';
  upiPlain.style.display = isMobile ? 'none' : 'block';
  copyFull.style.display = isMobile ? 'flex' : 'none';
}

/* --- QR toggle (mobile) --- */
showQRtoggle.addEventListener('click', ()=>{
  const open = scanpay.style.display !== 'block';
  scanpay.style.display = open ? 'block' : 'none';
});

/* --- Copy full-width --- */
if(copyWide){
  copyWide.addEventListener('click', async ()=>{
    try{ await navigator.clipboard.writeText(UPI_ID); showToast('UPI ID copied'); }
    catch(e){ alert('Copy failed ‚Äî use: ' + UPI_ID); }
  });
}

/* --- Amount logic --- */
document.querySelectorAll('.preset').forEach(b => b.addEventListener('click', ()=>{
  amountInput.value = b.dataset.val;
  refreshAmount();
}));
amountInput.addEventListener('input', refreshAmount);
function refreshAmount(){
  const v = Number(amountInput.value) || 0;
  bigAmount.textContent = '‚Çπ ' + (v>0? v.toLocaleString() : '0');
  qrImg.title = buildUPI(v);
}

/* --- Open form --- */
openFormBtn.addEventListener('click', ()=> window.open(FORM_URL,'_blank'));

/* --- Init --- */
buildMethodsUI();
setupUI();
refreshAmount();

/* show plain UPI on desktop/iPad below QR, mobile not show UPI text anywhere (only full copy) */
if(upiPlain) upiPlain.textContent = UPI_ID;

/* QR fallback if local image missing */
qrImg.onerror = ()=>{
  const upi = buildUPI(Number(amountInput.value)||0);
  qrImg.src = 'https://chart.googleapis.com/chart?cht=qr&chs=240x240&chl=' + encodeURIComponent(upi);
};

/* accessible toggle via keyboard */
showQRtoggle.addEventListener('keydown',(e)=>{ if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); showQRtoggle.click(); } });
</script>
</body>
</html>
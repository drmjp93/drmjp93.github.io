<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Telemedicine ‚Äî Payment</title>
<meta name="description" content="Device aware UPI payment page ‚Äî Telemedicine" />
<style>
:root{
  --bg:#f5f7fa; --card:#fff; --muted:#6b7280; --accent:#0b1220;
  --pill-h:56px;
}
*{box-sizing:border-box}
body{
  margin:0; padding:20px;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg); color:var(--accent);
}

/* top */
.topbar{ display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.back{ background:#0b1220; color:#fff; padding:10px 14px; border-radius:10px; text-decoration:none; font-weight:800; }

/* grid */
.container{ max-width:1100px; margin:22px auto; display:grid; grid-template-columns:1fr 460px; gap:20px; align-items:flex-start;}
@media(max-width:920px){ .container{ grid-template-columns:1fr; } }

/* left card */
.card-left{ background:#0b1220; color:#fff; border-radius:14px; padding:22px; min-height:520px; }
.card-left h2{ margin:0 0 12px; font-size:1.4rem; }
.rules{ color:#e6eef9; line-height:1.6; }

/* right card */
.card-right{ background:var(--card); border-radius:14px; padding:18px; box-shadow:0 8px 30px rgba(15,15,15,0.06); }
.alert{ background:#fffbea; border:1px solid #f6e29b; padding:10px 12px; border-radius:10px; font-weight:700; margin-bottom:14px; color:#6b7280; }

/* method pills (mobile) */
.methods{ display:flex; flex-direction:column; gap:12px; margin-bottom:12px; }
.pill{ display:flex; align-items:center; height:var(--pill-h); border-radius:12px; background:#fff; border:1px solid #e9eef6; overflow:hidden; }
.pill .left{ padding:12px 14px; flex:1; display:flex; flex-direction:column; gap:4px; }
.pill .title{ font-weight:900; font-size:1rem; }
.pill .desc{ color:var(--muted); font-size:.9rem; }
.pill .action{ width:110px; background:#0b1220; color:#fff; display:flex; align-items:center; justify-content:center; font-weight:900; cursor:pointer; }

/* show QR toggle */
#showQRtoggle{ margin-top:8px; background:#eef2f7; border-radius:8px; padding:10px; text-align:center; font-weight:700; cursor:pointer; }

/* Scan & Pay card (two-column inside) */
.scanpay{ margin-top:12px; border:1px solid #e7eef6; border-radius:12px; padding:12px; background:#fff; }
.scanpay .row{ display:flex; gap:12px; align-items:center; }
.scanpay .leftLabel{ flex:0 0 120px; border-radius:8px; background:#f8fafc; display:flex; align-items:center; justify-content:center; font-weight:900; color:#0b1220; height:120px; text-align:center; padding:8px; }
.scanpay .rightQR{ flex:1; display:flex; align-items:center; gap:12px; padding:8px; }
.qr-img{ width:120px; height:120px; border-radius:8px; border:1px solid #eaeff6; object-fit:cover; background:#fff; }
.qr-sep{ width:1px; height:96px; background:#eef2f7; }

/* UPI row inside scan card (below QR) */
.upi-row{ margin-top:12px; display:flex; gap:10px; align-items:center; justify-content:space-between; }
.upi-id{ flex:1; background:#f9fafb; border:1px solid #eef2f7; padding:10px; border-radius:10px; font-weight:900; color:#0b1220; text-align:left; }
.copy-btn{ background:#0b1220; color:#fff; padding:8px 12px; border-radius:10px; border:0; font-weight:800; cursor:pointer; }

/* Desktop: show upi text, hide copy button */
@media(min-width:921px){
  .copy-btn{ display:none !important; }
  .upi-id{ display:block !important; }
}
/* Mobile: hide upi plain text, show copy button */
@media(max-width:920px){
  .upi-id{ display:none !important; }
  .copy-btn{ display:inline-block !important; }
}

/* Copy full-width button (below scan card) */
.copy-full{ margin-top:12px; display:flex; gap:8px; }
.copy-full .copywide{ flex:1; background:#0b1220; color:#fff; padding:12px; border-radius:10px; border:0; font-weight:900; cursor:pointer; }

/* Amount / presets */
.amount-row{ margin-top:12px; display:flex; gap:8px; align-items:center; }
.amount-row label{ font-weight:900; min-width:70px; }
.amount-row input{ padding:8px 10px; border-radius:8px; border:1px solid #ddd; width:120px; text-align:center; font-weight:800; }
.preset{ padding:8px 12px; border-radius:8px; background:#eef6ff; border:1px solid #e0efff; font-weight:800; cursor:pointer; }

/* total summary bar with amount on right */
.totalbar{ margin-top:14px; display:flex; align-items:center; justify-content:space-between; background:#f1f6fb; padding:14px; border-radius:10px; }
.totalbar .label{ color:var(--muted); font-weight:800; }
.totalbar .amt{ font-weight:900; font-size:1.3rem; background:#fff; padding:6px 12px; border-radius:8px; }

/* split CTA: Submit after payment | Open form */
.split-cta{ margin-top:18px; display:flex; border-radius:12px; overflow:hidden; border:1px solid #e7eef6; background:#fff; height:64px; }
.split-cta .left{ flex:1; padding:10px 14px; display:flex; flex-direction:column; justify-content:center; }
.split-cta .left .l1{ font-weight:900; font-size:1.02rem; color:#0b1220; text-transform:uppercase; }
.split-cta .left .l2{ color:var(--muted); font-weight:700; font-size:.9rem; margin-top:4px; }
.split-cta .right{ width:160px; background:#0b1220; color:#fff; display:flex; align-items:center; justify-content:center; font-weight:900; cursor:pointer; }

/* responsive adjustments */
@media(max-width:640px){
  .scanpay .row{ flex-direction:column; align-items:stretch; }
  .scanpay .leftLabel{ width:100%; height:72px; }
  .qr-img{ width:160px; height:160px; margin:auto; }
  .split-cta{ flex-direction:row; height:auto; }
  .split-cta .right{ width:140px; padding:12px 10px; }
}
@media(max-width:420px){
  .split-cta{ flex-direction:column; }
  .split-cta .right{ width:100%; border-top:1px solid rgba(0,0,0,0.04); }
}

/* small toast */
#openToast{ position:fixed; left:50%; transform:translateX(-50%); bottom:22px; background:rgba(11,18,32,0.95); color:#fff; padding:10px 14px; border-radius:12px; display:none; font-weight:700; z-index:9999; }
</style>
</head>
<body>

<div class="topbar">
  <a class="back" href="telemedicine.html">‚Üê Back</a>
  <div style="color:var(--muted);font-weight:700">Secure payment</div>
</div>

<div class="container">
  <!-- LEFT: rules -->
  <aside class="card-left">
    <h2>Telemedicine ‚Äî Rules</h2>
    <div class="rules">
      <p><strong>Before consultation</strong></p>
      <ul>
        <li>Appointment given only after payment.</li>
        <li>Fill confirmation form after payment to share contact & payment details.</li>
        <li>Emergency ‚Üí go to nearest hospital immediately.</li>
      </ul>

      <p style="margin-top:10px;"><strong>Follow-up</strong></p>
      <ul>
        <li>Same problem within 72 hrs ‚Äî free.</li>
        <li>After 72 hrs ‚Äî ‚Çπ300.</li>
      </ul>

      <p style="margin-top:14px;color:#dbe6f5;">After payment, please fill the confirmation form. Consultation slot details will be shared on that number.</p>
    </div>
  </aside>

  <!-- RIGHT: payment -->
  <section class="card-right">
    <div class="alert">‚ö†Ô∏è Confirm Payee Name: <strong>Mit J Panchani</strong></div>

    <!-- mobile methods (pills) -->
    <div id="methodsWrapper" class="methods"></div>

    <!-- show QR toggle (mobile) -->
    <div id="showQRtoggle">üì∑ Show QR Code</div>

    <!-- Scan & Pay card -->
    <div class="scanpay" id="scanpay">
      <div class="row">
        <div class="leftLabel">SCAN &amp; PAY</div>
        <div class="rightQR">
          <img id="qrImg" class="qr-img" src="qr.jpg" alt="QR">
          <div style="flex:1;">
            <div style="font-weight:700;margin-bottom:8px;">UPI ID</div>
            <div style="display:flex; gap:8px; align-items:center;">
              <div class="upi-id" id="upiText">drmjp93@upi</div>
              <button class="copy-btn" id="copyQRupi">Copy</button>
            </div>
          </div>
        </div>
      </div>
      <!-- additional UPI row (for desktop/mobile redundancy if needed) -->
    </div>

    <!-- full-width copy (optionally visible on some layouts) -->
    <div class="copy-full">
      <button class="copywide" id="copyWide">Copy UPI ID</button>
    </div>

    <!-- Amount controls -->
    <div class="amount-row">
      <label for="amountInput">Amount</label>
      <input id="amountInput" type="number" value="400" min="1">
      <button class="preset" data-val="400">‚Çπ400</button>
      <button class="preset" data-val="300">‚Çπ300</button>
    </div>

    <!-- Total bar -->
    <div class="totalbar">
      <div class="label">Total price</div>
      <div class="amt" id="bigAmount">‚Çπ 400</div>
    </div>

    <!-- split CTA -->
    <div class="split-cta">
      <div class="left">
        <div class="l1">SUBMIT AFTER PAYMENT</div>
        <div class="l2">Fill confirmation form (compulsory)</div>
      </div>
      <div class="right" id="openFormBtn">OPEN FORM</div>
    </div>
  </section>
</div>

<div id="openToast" role="status" aria-live="polite"></div>

<script>
/* device detection */
function isAndroid(){ return /Android/i.test(navigator.userAgent); }
function isIOS(){ return /iPhone|iPad|iPod/i.test(navigator.userAgent) || (navigator.platform==='MacIntel' && navigator.maxTouchPoints>1); }
const device = isAndroid() ? 'android' : isIOS() ? 'ios' : 'desktop';
document.body.classList.add('is-' + device);

/* config */
const UPI_ID = 'drmjp93@upi';
const PAYEE = 'Mit J Panchani';
const NOTE = 'Telemedicine Consultation';
const FORM_URL = 'https://docs.google.com/forms/d/e/1FAIpQLSegoCeodeLpgCAXnSki_0kS74YONXKT_RtRl5jlyX9hAfmtbw/viewform?usp=dialog';

/* elements */
const wrapper = document.getElementById('methodsWrapper');
const qrCard = document.getElementById('scanpay');
const showQRtoggle = document.getElementById('showQRtoggle');
const copyBtn = document.getElementById('copyQRupi');
const copyWide = document.getElementById('copyWide');
const upiText = document.getElementById('upiText');
const qrImg = document.getElementById('qrImg');
const amountInput = document.getElementById('amountInput');
const bigAmount = document.getElementById('bigAmount');
const openFormBtn = document.getElementById('openFormBtn');

/* methods data */
const METHODS = {
  whatsapp:{ title:'WhatsApp Pay', desc:'Open WhatsApp UPI', pkg:null },
  gpay:{ title:'Google Pay', desc:'Open GPay', pkg:'com.google.android.apps.nbu.paisa.user' },
  phonepe:{ title:'PhonePe', desc:'Open PhonePe', pkg:'com.phonepe.app' },
  bhim:{ title:'BHIM / UPI', desc:'Open any UPI app', pkg:'in.org.npci.upiapp' }
};

/* helpers */
function enc(s){ return encodeURIComponent(s); }
function buildUPI(amount){
  const a = Number(amount)||0;
  const safe = (isFinite(a)&&a>0)? a.toFixed(2) : '0.00';
  return `upi://pay?pa=${enc(UPI_ID)}&pn=${enc(PAYEE)}&am=${enc(safe)}&tn=${enc(NOTE)}&cu=INR`;
}
function intentURI(pkg, upi){
  return `intent://${upi.replace('upi://','')}#Intent;package=${pkg};scheme=upi;end`;
}
function showToast(msg, ms=900){
  const t = document.getElementById('openToast');
  t.textContent = msg; t.style.display='block';
  clearTimeout(t._timer); t._timer = setTimeout(()=> t.style.display='none', ms);
}

/* build mobile pills */
function createPill(key, def){
  const el = document.createElement('div'); el.className='pill';
  el.innerHTML = `<div class="left"><div class="title">${def.title}</div><div class="desc">${def.desc}</div></div><div class="action">Open</div>`;
  el.onclick = ()=>{
    const upi = buildUPI(amountInput.value);
    if(device === 'android' && def.pkg){
      window.location.href = intentURI(def.pkg, upi);
    } else {
      window.location.href = upi;
    }
  };
  return el;
}
function buildMethods(){
  wrapper.innerHTML = '';
  if(device === 'desktop') return;
  if(device === 'ios'){
    wrapper.appendChild(createPill('whatsapp', METHODS.whatsapp));
    wrapper.appendChild(createPill('bhim', METHODS.bhim));
  } else {
    wrapper.appendChild(createPill('gpay', METHODS.gpay));
    wrapper.appendChild(createPill('phonepe', METHODS.phonepe));
    wrapper.appendChild(createPill('bhim', METHODS.bhim));
    wrapper.appendChild(createPill('whatsapp', METHODS.whatsapp));
  }
}

/* QR toggle */
showQRtoggle.onclick = ()=>{
  const disp = qrCard.style.display === 'block' ? 'none' : 'block';
  qrCard.style.display = disp;
};

/* copy handlers */
async function copyUPI(){
  try{
    await navigator.clipboard.writeText(UPI_ID);
    showToast('UPI ID copied');
  }catch(e){ alert('Copy failed ‚Äî use: '+UPI_ID); }
}
copyBtn.addEventListener('click', (e)=>{ e.stopPropagation(); copyUPI(); });
copyWide.addEventListener('click', copyUPI);

/* open form */
openFormBtn.addEventListener('click', ()=> window.open(FORM_URL,'_blank'));

/* amount logic */
document.querySelectorAll('.preset').forEach(b=> b.addEventListener('click', ()=>{ amountInput.value = b.dataset.val; refresh(); }));
amountInput.addEventListener('input', refresh);
function refresh(){
  const v = Number(amountInput.value) || 0;
  bigAmount.textContent = '‚Çπ ' + (v>0? v.toLocaleString() : '0');
  // update QR title and fallback URL
  qrImg.title = buildUPI(v);
}

/* init */
buildMethods();
refresh();

// show QR on desktop by default, hide toggle
if(device === 'desktop'){
  qrCard.style.display = 'block';
  showQRtoggle.style.display = 'none';
} else {
  qrCard.style.display = 'none';
  showQRtoggle.style.display = 'block';
}

/* ensure UPI UI: desktop shows text, mobile shows copy button (CSS handles but set explicit) */
if(window.matchMedia('(min-width:921px)').matches){
  upiText.style.display = 'block';
  copyBtn.style.display = 'none';
} else {
  upiText.style.display = 'none';
  copyBtn.style.display = 'inline-block';
}

/* qr fallback to google if local missing */
qrImg.onerror = ()=>{
  const upi = buildUPI(Number(amountInput.value)||0);
  qrImg.src = 'https://chart.googleapis.com/chart?cht=qr&chs=240x240&chl=' + encodeURIComponent(upi);
};
</script>
</body>
</html>